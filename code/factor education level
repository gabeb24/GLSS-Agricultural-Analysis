
# ---- General Education ----

edu_agg <- education %>% # general education @ individual level
  
 # no_education column gives a 1 to those  households without any education and a 0 to all other households.
  mutate(
    no_education = case_when(
      s2aq1 == 2 ~ 1,
      s2aq1== 1 ~ 0,
      TRUE ~ 1
    )
  ) %>%  
  
  #  koranic_kinder_educ column gives a 1 to those  household's  where this is the highest education level in the household and a 0 to all other households.
  mutate(
    koranic_kinder_educ = case_when(
      is.na(s2aq2) ~ 0,
      s2aq2 ==2 ~ 1,
      s2aq2 ==1 ~ 1,
      s2aq2 !=2 ~ 0,
      s2aq2 !=1~ 0,
      TRUE ~ 1
    )
  ) %>% 
  
  # prim_educ column gives a 1 to those households with primary education as the highest household education level and a 0 to all other households.
  mutate(
    prim_educ = case_when(
      is.na(s2aq2) ~ 0,
      s2aq2 == 3 ~ 1,
      s2aq2 != 3 ~ 0,
      TRUE ~ 1
    )
  ) %>% 
  
  # sec_educ column gives a 1 to those with secondary education as the highest househiold education level and a 0 to all other households.
  mutate(
    sec_educ = case_when(
      is.na(s2aq2) ~ 0,
      s2aq2 < 3 ~ 0,
      s2aq2 ==3 ~ 0,
      s2aq2 > 3 ~ 1,
      TRUE ~ 1
    )
  ) 

# Grouped by household we now see the highest level of our 4 levels of education 
# achieved for each household indicated by a 1 value in the highest level category

hh_edu_ag <- group_by(edu_agg, clust, nh)%>%
  select(clust,nh,no_education,koranic_kinder_educ,prim_educ,sec_educ)#select the columns to keep from data base
